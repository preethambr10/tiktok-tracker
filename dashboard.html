<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TikTok Outreach Dashboard</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=JetBrains+Mono:wght@400;600;700&display=swap');

  :root {
    --bg:#080810; --surface:#0f0f1a; --surface2:#181828; --surface3:#1e1e32;
    --accent:#fe2c55; --cyan:#25f4ee; --green:#1aff8c; --yellow:#facc15;
    --purple:#a855f7; --text:#eeeef5; --muted:#5a5a75; --border:rgba(255,255,255,0.06);
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:var(--bg);color:var(--text);font-family:'JetBrains Mono',monospace;min-height:100vh;overflow-x:hidden;}
  body::before{content:'';position:fixed;inset:0;z-index:0;
    background-image:linear-gradient(rgba(37,244,238,0.025) 1px,transparent 1px),linear-gradient(90deg,rgba(37,244,238,0.025) 1px,transparent 1px);
    background-size:44px 44px;pointer-events:none;}
  .wrap{max-width:1500px;margin:0 auto;padding:0 24px;position:relative;z-index:1;}

  /* HEADER */
  header{padding:36px 0 26px;border-bottom:1px solid var(--border);margin-bottom:26px;}
  .hrow{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:16px;}
  .brand-tag{font-size:10px;letter-spacing:0.25em;text-transform:uppercase;color:var(--muted);margin-bottom:6px;}
  .brand-title{font-family:'Syne',sans-serif;font-size:clamp(22px,4vw,44px);font-weight:800;line-height:1;}
  .brand-title em{color:var(--cyan);font-style:normal;}
  .hright{display:flex;flex-direction:column;align-items:flex-end;gap:8px;}
  .live-dot{display:flex;align-items:center;gap:7px;font-size:11px;}
  .live-dot.online{color:var(--green);}
  .live-dot.offline{color:var(--accent);}
  .dot{width:8px;height:8px;border-radius:50%;}
  .dot.g{background:var(--green);animation:pulse 1.5s infinite;}
  .dot.r{background:var(--accent);}
  @keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.4;transform:scale(0.7)}}
  .sync-info{font-size:10px;color:var(--muted);}

  /* CONNECTION STATUS BANNER */
  #connBanner{
    display:none;background:rgba(254,44,85,0.1);border:1px solid rgba(254,44,85,0.3);
    border-radius:6px;padding:12px 18px;margin-bottom:20px;
    font-size:12px;color:var(--accent);line-height:1.6;
  }
  #connBanner.show{display:block;}

  /* PROGRESS */
  .prog-section{margin-bottom:22px;}
  .prog-top{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:10px;flex-wrap:wrap;gap:8px;}
  .prog-label{font-family:'Syne',sans-serif;font-size:12px;font-weight:700;letter-spacing:0.12em;text-transform:uppercase;color:var(--muted);}
  .prog-pct{font-family:'Syne',sans-serif;font-size:36px;font-weight:800;color:var(--green);}
  .prog-track{width:100%;height:10px;background:var(--surface2);border-radius:5px;overflow:hidden;border:1px solid var(--border);}
  .prog-fill{height:100%;background:linear-gradient(90deg,var(--cyan),var(--green));border-radius:5px;transition:width 0.9s cubic-bezier(0.16,1,0.3,1);min-width:0;}
  .prog-sub{display:flex;gap:20px;margin-top:10px;flex-wrap:wrap;}
  .pi-item{font-size:11px;} .pi-item b{font-weight:700;}
  .pi-item.g b{color:var(--green);} .pi-item.r b{color:var(--accent);} .pi-item.m b{color:var(--muted);}

  /* STATS */
  .stats-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(148px,1fr));gap:10px;margin-bottom:22px;}
  .stat{background:var(--surface);border:1px solid var(--border);border-radius:6px;padding:16px;transition:border-color 0.2s;}
  .stat:hover{border-color:var(--cyan);}
  .stat-lbl{font-size:9px;letter-spacing:0.2em;text-transform:uppercase;color:var(--muted);margin-bottom:8px;}
  .stat-val{font-family:'Syne',sans-serif;font-size:24px;font-weight:800;}
  .stat-val.g{color:var(--green);} .stat-val.r{color:var(--accent);} .stat-val.c{color:var(--cyan);} .stat-val.y{color:var(--yellow);}

  /* CONTROLS */
  .controls{display:flex;flex-wrap:wrap;gap:9px;margin-bottom:18px;align-items:center;}
  input[type=text],select{background:var(--surface);border:1px solid var(--border);border-radius:4px;padding:8px 13px;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:12px;outline:none;transition:border-color 0.2s;}
  input[type=text]{width:210px;} input[type=text]::placeholder{color:var(--muted);}
  input[type=text]:focus{border-color:var(--cyan);} select:focus{border-color:var(--accent);}
  .pills{display:flex;flex-wrap:wrap;gap:6px;}
  .pill{background:var(--surface2);border:1px solid var(--border);border-radius:100px;padding:5px 12px;font-size:10px;cursor:pointer;transition:all 0.2s;white-space:nowrap;}
  .pill:hover,.pill.on{background:var(--accent);border-color:var(--accent);color:#fff;}
  .pill.all.on{background:var(--cyan);border-color:var(--cyan);color:#000;}
  .stabs{display:flex;gap:5px;}
  .stab{background:var(--surface2);border:1px solid var(--border);border-radius:4px;padding:7px 13px;font-size:11px;cursor:pointer;transition:all 0.2s;white-space:nowrap;}
  .stab.on-all{border-color:var(--cyan);color:var(--cyan);}
  .stab.on-reached{border-color:var(--green);color:var(--green);background:rgba(26,255,140,0.08);}
  .stab.on-unreached{border-color:var(--accent);color:var(--accent);background:rgba(254,44,85,0.08);}

  /* TABLE */
  .table-card{background:var(--surface);border:1px solid var(--border);border-radius:6px;overflow:hidden;margin-bottom:18px;}
  .table-hdr{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:8px;}
  .table-title{font-family:'Syne',sans-serif;font-size:14px;font-weight:700;}
  .cbadge{font-size:10px;color:var(--muted);background:var(--surface2);padding:3px 10px;border-radius:100px;}
  .tw{overflow-x:auto;}
  table{width:100%;border-collapse:collapse;}
  th{text-align:left;padding:10px 14px;font-size:9px;letter-spacing:0.18em;text-transform:uppercase;color:var(--muted);border-bottom:1px solid var(--border);background:var(--surface2);white-space:nowrap;cursor:pointer;user-select:none;}
  th:hover{color:var(--cyan);} th.sorted{color:var(--cyan);}
  tr.row{border-bottom:1px solid var(--border);transition:background 0.12s;}
  tr.row:hover{background:var(--surface2);}
  tr.row:last-child{border-bottom:none;}
  tr.row.is-reached{border-left:3px solid var(--green);}
  tr.row.is-unreached{border-left:3px solid transparent;}
  td{padding:10px 14px;font-size:11px;vertical-align:middle;}
  .spill{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:100px;font-size:10px;font-weight:700;}
  .spill.reached{background:rgba(26,255,140,0.12);color:var(--green);border:1px solid rgba(26,255,140,0.3);}
  .spill.unreached{background:rgba(254,44,85,0.1);color:var(--accent);border:1px solid rgba(254,44,85,0.2);}
  .uname a{color:var(--cyan);text-decoration:none;font-weight:600;}
  .uname a:hover{text-decoration:underline;}
  .ntag{display:inline-block;padding:2px 9px;border-radius:100px;font-size:9px;font-weight:700;}
  .fbar{display:flex;align-items:center;gap:7px;}
  .fmini{height:3px;border-radius:2px;min-width:3px;}
  .rnum{color:var(--muted);font-size:10px;}

  /* PAGINATION */
  .pag{display:flex;justify-content:center;align-items:center;gap:5px;padding:16px;border-top:1px solid var(--border);flex-wrap:wrap;}
  .pb{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:6px 10px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:11px;cursor:pointer;transition:all 0.2s;}
  .pb:hover:not(:disabled){border-color:var(--cyan);color:var(--cyan);}
  .pb.act{background:var(--accent);border-color:var(--accent);color:#fff;}
  .pb:disabled{opacity:0.25;cursor:not-allowed;}
  .pinfo{font-size:11px;color:var(--muted);padding:0 4px;}

  /* TOAST */
  #toast{position:fixed;bottom:24px;right:24px;z-index:9999;background:var(--surface3);border:1px solid var(--green);color:var(--green);padding:11px 18px;border-radius:6px;font-size:12px;font-weight:600;transform:translateY(70px);opacity:0;transition:all 0.3s cubic-bezier(0.16,1,0.3,1);pointer-events:none;max-width:280px;}
  #toast.show{transform:translateY(0);opacity:1;}

  @keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}
  .fu{animation:fadeUp 0.4s ease both;}
  .fu2{animation:fadeUp 0.4s 0.08s ease both;}
  .fu3{animation:fadeUp 0.4s 0.16s ease both;}
  footer{border-top:1px solid var(--border);padding:18px 0;text-align:center;font-size:10px;color:var(--muted);margin-top:8px;line-height:1.8;}
</style>
</head>
<body>
<div class="wrap">

  <header class="fu">
    <div class="hrow">
      <div>
        <div class="brand-tag">TikTok Outreach Tracker</div>
        <h1 class="brand-title">Creator <em>Reach</em> Dashboard</h1>
      </div>
      <div class="hright">
        <div class="live-dot online" id="liveStatus">
          <div class="dot g" id="liveDot"></div>
          <span id="liveText">Connecting to bot‚Ä¶</span>
        </div>
        <div class="sync-info" id="syncInfo">Last sync: never</div>
      </div>
    </div>
  </header>

  <!-- Connection banner -->
  <div id="connBanner">
    ‚ö†Ô∏è <b>Bot server not detected.</b> Make sure <code>bot-server.js</code> is running on your PC.<br>
    Run: <code>node bot-server.js</code> ‚Äî then refresh this page.<br>
    Dashboard will work in read-only mode until bot is connected.
  </div>

  <!-- Progress -->
  <div class="prog-section fu2">
    <div class="prog-top">
      <div class="prog-label">Overall Outreach Progress</div>
      <div class="prog-pct" id="progPct">0%</div>
    </div>
    <div class="prog-track"><div class="prog-fill" id="progFill" style="width:0%"></div></div>
    <div class="prog-sub">
      <div class="pi-item g">‚úÖ Reached: <b id="reachedCnt">0</b></div>
      <div class="pi-item r">‚è≥ Unreached: <b id="unreachedCnt">10,000</b></div>
      <div class="pi-item m">Total: <b>10,000</b></div>
    </div>
  </div>

  <!-- Stats -->
  <div class="stats-row fu2" id="statsRow"></div>

  <!-- Controls -->
  <div class="controls fu3">
    <input type="text" id="searchBox" placeholder="Search @username‚Ä¶">
    <select id="sortSel">
      <option value="followers_desc">‚Üì Most Followers</option>
      <option value="followers_asc">‚Üë Least Followers</option>
      <option value="username_asc">A‚ÄìZ Username</option>
      <option value="reached_first">‚úÖ Reached First</option>
    </select>
    <div class="stabs">
      <div class="stab on-all" id="tabAll"     onclick="setStatus('all')">üåê All</div>
      <div class="stab"        id="tabReached"  onclick="setStatus('reached')">‚úÖ Reached</div>
      <div class="stab"        id="tabUnreached"onclick="setStatus('unreached')">‚è≥ Unreached</div>
    </div>
    <div class="pills" id="nichePills"></div>
  </div>

  <!-- Table -->
  <div class="table-card fu3">
    <div class="table-hdr">
      <div class="table-title">Creator Accounts</div>
      <div class="cbadge" id="cntBadge">10,000 accounts</div>
    </div>
    <div class="tw">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th class="sortable" data-col="username">Username ‚áÖ</th>
            <th class="sortable sorted" data-col="followers">Followers ‚Üì</th>
            <th>Niche</th>
            <th>Status</th>
            <th>Profile Link</th>
          </tr>
        </thead>
        <tbody id="tBody"></tbody>
      </table>
    </div>
    <div class="pag" id="pagDiv"></div>
  </div>

  <footer>
    Dashboard hosted on GitHub Pages ¬∑ Bot server runs locally on your PC<br>
    Send TikTok links to your Telegram bot ‚Üí rows turn green ‚úÖ automatically
  </footer>
</div>

<div id="toast"></div>

<script>
// ‚îÄ‚îÄ NICHES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const NICHES = [
  {name:'Movies',            emoji:'üé¨', color:'#fe2c55'},
  {name:'Memes',             emoji:'üòÇ', color:'#ff6b35'},
  {name:'Podcast',           emoji:'üéôÔ∏è', color:'#a855f7'},
  {name:'Gaming',            emoji:'üéÆ', color:'#25f4ee'},
  {name:'Music',             emoji:'üéµ', color:'#f472b6'},
  {name:'Transitional Edit', emoji:'‚úÇÔ∏è', color:'#facc15'},
];

const PREFIXES = ['the','real','official','daily','pro','top','best','hot','viral','mega','super','ultra','xo','og','idk','not','just','only','pure','raw'];
const WORDS = {
  'Movies':            ['cinephile','filmlab','reelz','screentime','blockbuster','director','clapboard','oscarbuzz','moviebuff','cineclub','cinemacore','ratedx','scenecut','framelab','watchlist','plottwist','cinematix','reelclub','filmnerd','scorecard','movierec','cinehour','reelroom','filmchat','cutprint','screentalk','popfilm','cinemix','watchroom','filmfan','cinepop','reelhead','filmfreek','cinewave','boxoffice'],
  'Memes':             ['memekid','laughtrack','dankpost','viralol','gigachad','memeworld','funnyfarm','lolcontent','memegod','dankverse','cursedpost','memeflop','ironypost','ratpost','chronically','npcmode','skibbidi','brainrot','copium','glazed','memehub','postirony','chaospost','doomscroll','memeguru','voidpost','memecycle','lolwave','danklab','memenet','shitpost','ironymaxxed','baitpost','ratioed','memelord'],
  'Podcast':           ['podlife','castaway','episodic','podwave','deepdive','talkshow','audiobyte','storytime','podcrafter','voiceover','longform','hotmic','takepod','narrativ','rawcast','unfiltered','twocents','podhead','microphone','riffcast','castlab','podroom','openmic','tapecast','podcore','audiodraft','livepod','castmate','podstream','recordroom','talkhour','castpro','podcrew','speakup','miccheck'],
  'Gaming':            ['gamerx','pixelpunk','framerate','respawn','glitchgod','speedrun','lootdrop','esportshub','noobkiller','xp_grind','lagcomp','clutchking','wasdonly','aimgod','mobaplayer','sweatlord','rankgrind','patchnotes','healbot','tankmain','fragpost','ggez','1v1me','loadout','gamelab','deathloop','spawncamp','superloot','netcode','gamevault','aimlab','fraglord','rankup','pushmaster','grindmode'],
  'Music':             ['beatdrop','melodyhub','soundbyte','riffmaster','bassline','noteworthy','vocalfry','beatmaker','tunelabs','rhymezone','lofiwave','chordprog','samplepack','synth_kid','pitchshift','freqband','tracklab','cuepoint','waveform','bpmlab','beatcraft','studiorat','mixdown','looplord','tempolab','dropzone','beatroom','audiophil','soundlab','reverbkid','basshead','drumkit','melodic','synthwave','beatlab'],
  'Transitional Edit': ['editflow','transmaster','cutscene','editgod','smoothcut','blendlab','capcut_pro','editphase','morphcut','reelcraft','flashedit','editbrain','syncbeat','visulab','dripcut','maskblend','zoomcut','editwave','clipforge','translab','editpunk','cutmaster','layerlab','editdrop','vizcraft','glitchedit','motionedit','editfire','clipcraft','transwave','edithaus','cutlab','vizpro','blendmaster','editcore'],
};

function fmt(n){if(n>=1000000)return(n/1000000).toFixed(1)+'M';if(n>=1000)return(n/1000).toFixed(1)+'K';return String(n);}
function rand(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function pick(arr){return arr[Math.floor(Math.random()*arr.length)];}

// ‚îÄ‚îÄ GENERATE 10,000 accounts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function generateData(){
  const data=[];let id=1;
  const perNiche=[1667,1667,1667,1667,1666,1666];
  NICHES.forEach((niche,ni)=>{
    const words=WORDS[niche.name];
    const count=perNiche[ni];
    const highCount=Math.round(count*0.10); // 10% = 100K-200K
    for(let i=0;i<count;i++){
      let followers;
      if(i<highCount){
        followers=rand(100000,200000);
      } else {
        const r=Math.random();
        if(r<0.10)      followers=rand(80001,100000);
        else if(r<0.28) followers=rand(50001,80000);
        else if(r<0.55) followers=rand(20001,50000);
        else if(r<0.80) followers=rand(10001,20000);
        else            followers=rand(5000,10000);
      }
      const word=pick(words);
      const prefix=Math.random()>0.55?pick(PREFIXES)+'_':'';
      const suffix=Math.random()>0.55?'_'+rand(10,999):'';
      const username=prefix+word+suffix;
      data.push({id:id++,username,followers,niche:niche.name,link:`https://tiktok.com/@${username}`});
    }
  });
  // Shuffle so tiers are mixed
  for(let i=data.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [data[i],data[j]]=[data[j],data[i]];
  }
  return data;
}

const ALL_DATA = generateData();

// ‚îÄ‚îÄ REACHED STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let reachedSet = new Set();
let botOnline = false;

// Fetch reached.json from local bot server
async function syncReached(){
  try {
    const res = await fetch('http://localhost:3001/reached?t='+Date.now());
    if(!res.ok) throw new Error('not ok');
    const data = await res.json();
    const prev = reachedSet.size;
    const newSet = new Set((data.reached||[]).map(r=>r.username.toLowerCase()));

    if(!botOnline){
      botOnline=true;
      setOnline(true);
      document.getElementById('connBanner').classList.remove('show');
    }

    document.getElementById('syncInfo').textContent='Last sync: '+new Date().toLocaleTimeString();

    if(newSet.size!==prev){
      reachedSet=newSet;
      applyFilters();
      if(newSet.size>prev){
        const added=newSet.size-prev;
        showToast(`‚úÖ ${added} new account${added>1?'s':''} marked reached!`);
      }
    } else {
      reachedSet=newSet;
    }
  } catch {
    if(botOnline){
      botOnline=false;
      setOnline(false);
      document.getElementById('connBanner').classList.add('show');
    }
    document.getElementById('syncInfo').textContent='Bot offline ‚Äî '+new Date().toLocaleTimeString();
  }
}

function setOnline(online){
  const ld=document.getElementById('liveStatus');
  const dot=document.getElementById('liveDot');
  const txt=document.getElementById('liveText');
  if(online){
    ld.className='live-dot online';
    dot.className='dot g';
    txt.textContent='Bot connected ‚úì';
  } else {
    ld.className='live-dot offline';
    dot.className='dot r';
    txt.textContent='Bot offline';
  }
}

function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),3500);
}

function isReached(u){return reachedSet.has(u.toLowerCase());}

// ‚îÄ‚îÄ FILTER STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let filtered=[...ALL_DATA];
let currentNiche='All',currentSort='followers_desc',currentPage=1,currentStatus='all',searchTerm='';
const PER_PAGE=25;

function getNicheColor(n){return NICHES.find(x=>x.name===n)?.color||'#888';}
function getNicheEmoji(n){return NICHES.find(x=>x.name===n)?.emoji||'';}

// ‚îÄ‚îÄ PROGRESS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderProgress(){
  const total=ALL_DATA.length;
  const reached=reachedSet.size;
  const pct=total?(reached/total*100).toFixed(1):0;
  document.getElementById('progPct').textContent=pct+'%';
  document.getElementById('progFill').style.width=pct+'%';
  document.getElementById('reachedCnt').textContent=reached.toLocaleString();
  document.getElementById('unreachedCnt').textContent=(total-reached).toLocaleString();
}

// ‚îÄ‚îÄ STATS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderStats(){
  const total=filtered.length;
  const totalF=filtered.reduce((s,a)=>s+a.followers,0);
  const avg=total?Math.round(totalF/total):0;
  const reached=filtered.filter(a=>isReached(a.username)).length;
  const niches=new Set(filtered.map(a=>a.niche)).size;
  document.getElementById('statsRow').innerHTML=`
    <div class="stat"><div class="stat-lbl">Showing</div><div class="stat-val c">${total.toLocaleString()}</div></div>
    <div class="stat"><div class="stat-lbl">Reached</div><div class="stat-val g">${reached.toLocaleString()}</div></div>
    <div class="stat"><div class="stat-lbl">Unreached</div><div class="stat-val r">${(total-reached).toLocaleString()}</div></div>
    <div class="stat"><div class="stat-lbl">Avg Followers</div><div class="stat-val">${fmt(avg)}</div></div>
    <div class="stat"><div class="stat-lbl">Active Niches</div><div class="stat-val y">${niches}</div></div>
  `;
}

// ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderTable(){
  const start=(currentPage-1)*PER_PAGE;
  const page=filtered.slice(start,start+PER_PAGE);
  const maxF=200000;
  document.getElementById('cntBadge').textContent=`${filtered.length.toLocaleString()} accounts`;
  document.getElementById('tBody').innerHTML=page.map((a,i)=>{
    const rank=start+i+1;
    const color=getNicheColor(a.niche);
    const reached=isReached(a.username);
    const barW=Math.max(3,Math.round(a.followers/maxF*90));
    return `<tr class="row ${reached?'is-reached':'is-unreached'}">
      <td class="rnum">${rank}</td>
      <td class="uname"><a href="${a.link}" target="_blank">@${a.username}</a></td>
      <td><div class="fbar"><span style="min-width:54px">${fmt(a.followers)}</span><div class="fmini" style="width:${barW}px;background:${color}"></div></div></td>
      <td><span class="ntag" style="background:${color}22;color:${color}">${getNicheEmoji(a.niche)} ${a.niche}</span></td>
      <td>${reached?'<span class="spill reached">‚úÖ Reached</span>':'<span class="spill unreached">‚è≥ Pending</span>'}</td>
      <td><a href="${a.link}" target="_blank" style="color:var(--muted);font-size:10px;text-decoration:none">‚Üó open</a></td>
    </tr>`;
  }).join('');
  renderPagination();
}

function renderPagination(){
  const pages=Math.ceil(filtered.length/PER_PAGE);
  if(!pages){document.getElementById('pagDiv').innerHTML='';return;}
  let html=`<button class="pb" onclick="goPage(${currentPage-1})" ${currentPage===1?'disabled':''}>‚Üê Prev</button>`;
  const s=Math.max(1,currentPage-2),e=Math.min(pages,s+4);
  if(s>1) html+=`<button class="pb" onclick="goPage(1)">1</button><span class="pinfo">‚Ä¶</span>`;
  for(let p=s;p<=e;p++) html+=`<button class="pb ${p===currentPage?'act':''}" onclick="goPage(${p})">${p}</button>`;
  if(e<pages) html+=`<span class="pinfo">‚Ä¶</span><button class="pb" onclick="goPage(${pages})">${pages}</button>`;
  html+=`<span class="pinfo">/ ${pages} pages</span>`;
  html+=`<button class="pb" onclick="goPage(${currentPage+1})" ${currentPage===pages?'disabled':''}>Next ‚Üí</button>`;
  document.getElementById('pagDiv').innerHTML=html;
}

function goPage(p){
  const pages=Math.ceil(filtered.length/PER_PAGE);
  if(p<1||p>pages)return;
  currentPage=p;
  renderTable();
  window.scrollTo({top:document.querySelector('.table-card').offsetTop-80,behavior:'smooth'});
}

// ‚îÄ‚îÄ PILLS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderPills(){
  document.getElementById('nichePills').innerHTML=['All',...NICHES.map(n=>n.name)].map(n=>`
    <div class="pill ${n==='All'?'all':''} ${currentNiche===n?'on':''}" onclick="setNiche('${n}')">
      ${n==='All'?'üåê All':getNicheEmoji(n)+' '+n}
    </div>`).join('');
}
function setNiche(n){currentNiche=n;applyFilters();renderPills();}

// ‚îÄ‚îÄ STATUS TABS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function setStatus(s){
  currentStatus=s;
  document.getElementById('tabAll').className      ='stab'+(s==='all'?      ' on-all':'');
  document.getElementById('tabReached').className  ='stab'+(s==='reached'?  ' on-reached':'');
  document.getElementById('tabUnreached').className='stab'+(s==='unreached'?' on-unreached':'');
  applyFilters();
}

// ‚îÄ‚îÄ FILTERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.getElementById('sortSel').addEventListener('change',e=>{currentSort=e.target.value;applyFilters();});
document.getElementById('searchBox').addEventListener('input',e=>{searchTerm=e.target.value.toLowerCase();applyFilters();});

function applyFilters(){
  filtered=ALL_DATA.filter(a=>{
    if(currentNiche!=='All'&&a.niche!==currentNiche)return false;
    if(searchTerm&&!a.username.toLowerCase().includes(searchTerm))return false;
    if(currentStatus==='reached'&&!isReached(a.username))return false;
    if(currentStatus==='unreached'&&isReached(a.username))return false;
    return true;
  });
  if(currentSort==='followers_desc')filtered.sort((a,b)=>b.followers-a.followers);
  else if(currentSort==='followers_asc')filtered.sort((a,b)=>a.followers-b.followers);
  else if(currentSort==='username_asc')filtered.sort((a,b)=>a.username.localeCompare(b.username));
  else if(currentSort==='reached_first')filtered.sort((a,b)=>{
    const ra=isReached(a.username)?1:0,rb=isReached(b.username)?1:0;
    return rb-ra||b.followers-a.followers;
  });
  currentPage=1;
  renderProgress();renderStats();renderTable();
}

document.querySelectorAll('th.sortable').forEach(th=>{
  th.addEventListener('click',()=>{
    document.querySelectorAll('th').forEach(t=>t.classList.remove('sorted'));
    th.classList.add('sorted');
    currentSort=th.dataset.col==='followers'?(currentSort==='followers_desc'?'followers_asc':'followers_desc'):'username_asc';
    document.getElementById('sortSel').value=currentSort;
    applyFilters();
  });
});

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
renderPills();
applyFilters();
syncReached();
setInterval(syncReached,5000); // poll every 5s
</script>
</body>
</html>
